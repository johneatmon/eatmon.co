---
import type { CollectionEntry } from "astro:content"

import LinkPreview from "@components/Glimpse"
import PostFooter from "@components/PostFooter.astro"
import ProjectHeader from "@components/ProjectHeader.astro"
import BaseLayout from "@layouts/BaseLayout.astro"

type Props = CollectionEntry<"project">["data"]

const data = Astro.props as Props

const { title, description, tags, caseStudy, modified, published } = data

const pathname = Astro.url.pathname
---

<BaseLayout
	title={title}
	description={description}
	type="article"
	section={caseStudy === true ? "Case Study" : "Project"}
	tags={tags}
	datePublished={published?.toString()}
	dateModified={modified?.toString()}
	image={{
		src: new URL(`${pathname.endsWith("/") ? pathname.slice(0, -1) : pathname}.og`, Astro.site)
			.href,
		alt: `Open Graph image for ${title}.`,
	}}
>
	<article class="mt pt-24 lg:pt-32">
		<ProjectHeader data={data} />
		<main
			class="prose prose-base prose-zinc my-16 max-w-max prose-headings:font-serif prose-headings:font-semibold prose-blockquote:font-serif prose-blockquote:text-lg prose-blockquote:font-medium prose-blockquote:italic prose-blockquote:tracking-normal prose-em:font-serif prose-pre:text-base dark:prose-invert"
		>
			<slot />
		</main>
		<PostFooter />
	</article>
	<LinkPreview client:idle />
</BaseLayout>
